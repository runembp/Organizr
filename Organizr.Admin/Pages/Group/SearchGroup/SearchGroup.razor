@page "/SearchGroup"
@using Organizr.Domain.Entities
@using Organizr.Application.Requests

<h3>Søg gruppe</h3>

<SearchBar/>

<DataGrid TItem="MemberGroup"
          Data="UserGroups"
          FixedHeader="true"
          Editable="true"
          RowSelectable="_ => false">
    <DataGridColumns>
        <DataGridCommandColumn NewCommandAllowed="false" EditCommandAllowed="false">
                <DeleteCommandTemplate>
                    <Button Size="Size.Small" Color="Color.Danger">Slet</Button>
                </DeleteCommandTemplate>
            </DataGridCommandColumn>
        <DataGridColumn Field="@nameof(MemberGroup.Id)" Caption="Gruppe ID">
            <DisplayTemplate>
                <Button Clicked="() => OnEditGroupLink_Clicked(context.Id)" Color="Color.Link">@context.Id</Button>
            </DisplayTemplate>
        </DataGridColumn>
        <DataGridColumn Field="@nameof(MemberGroup.Name)" Caption="Navn"/>
        <DataGridColumn Field="@nameof(MemberGroup.IsOpen)" Caption="Åben for alle">
            <DisplayTemplate>
                <Check TValue="bool" Checked="context.IsOpen" Disabled="true"></Check>
            </DisplayTemplate>
        </DataGridColumn>
    </DataGridColumns>
</DataGrid>

@code {

    private List<MemberGroup> UserGroups { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        var response = await Mediator.Send(new GetAllMemberGroupsRequest());
        UserGroups = (List<MemberGroup>) response.MemberGroups;
    }

    private void OnEditGroupLink_Clicked(int id)
    {
        NavigationManager.NavigateTo($"EditGroup/{id}");
    }

}