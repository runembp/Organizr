@page "/css-setup"

@attribute [Authorize]

<Heading Size="HeadingSize.Is3">Opsætning af CSS for Member-applikationen</Heading>

<Div>
    <Column ColumnSize="ColumnSize.Is6" Padding="Padding.Is0">
        <MemoEdit Rows="30" AutoSize @bind-Text="@ConfigCss.StringValue" Disabled="!_editingActivated"/>
    </Column>

    <Field TextAlignment="TextAlignment.End" ColumnSize="ColumnSize.Is6">
        <Check TValue="bool" @bind-Checked="_editingActivated">Aktiver Redigering</Check>
    </Field>

    <Button Color="Color.Primary" Clicked="OnSaveButton_Clicked">Gem</Button>

    <Column ColumnSize="ColumnSize.Is3">
        <Alert Visible="_configSaved" Color="Color.Success">
            <AlertMessage>Css Opsætningen er gemt</AlertMessage>
        </Alert>
    </Column>
</Div>

@code {
    private Configuration ConfigCss { get; set; } = new();
    private bool _editingActivated;
    private bool _configSaved;

    protected override async Task OnInitializedAsync()
    {
        var cssConfig = await ConfigurationService.GetAllConfigurationsOfType(ConfigType.CssSetup);
        ConfigCss = cssConfig.First();
    }

    private async Task OnSaveButton_Clicked()
    {
        _configSaved = false;

        await ConfigurationService.UpdateConfigurationsOfType(ConfigType.CssSetup, new List<Configuration> {ConfigCss});

        // if (response.Succeeded)
        // {
            // _configSaved = response.Succeeded;
        // }
    }

}