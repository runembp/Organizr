<Modal @ref="_removeMemberModal">
    <ModalContent>
        <ModalHeader>Fjern @Member.FirstName @Member.LastName fra @GroupToBeRemoved.Name?</ModalHeader>
        <ModalBody>
            <Div>
                <Button Color="Color.Danger" Clicked="OnRemoveButton_Clicked">Slet</Button>
                <Button Color="Color.Secondary" Clicked="OnCancelButton_Clicked">Afbryd</Button>
            </Div>
        </ModalBody>
    </ModalContent>
</Modal>

<Snackbar @ref="_snackbarSuccess" Color="SnackbarColor.Success">
    <SnackbarBody TextWeight="TextWeight.Bold">
        @GroupToBeRemoved.Name er fjernet fra @Member.FirstName @Member.LastName 
    </SnackbarBody>
</Snackbar>

<Snackbar @ref="_snackbarError" Color="SnackbarColor.Danger">
    <SnackbarBody TextWeight="TextWeight.Bold">
        @GroupToBeRemoved.Name kunne ikke fjernes fra @Member.FirstName @Member.LastName
    </SnackbarBody>
</Snackbar>

@code {

    [Parameter]
    public Member Member { get; set; } = new();

    [Parameter]
    public MemberGroup GroupToBeRemoved { get; set; } = new();

    [Parameter]
    public EventCallback OnGroupRemoved { get; set; }

    private Modal _removeMemberModal = new();
    private Snackbar _snackbarSuccess = new();
    private Snackbar _snackbarError = new();
    
    public async Task Show()
    {
        await _removeMemberModal.Show();
    }

    private async Task OnRemoveButton_Clicked()
    {
        var result = await GroupService.RemoveMemberFromGroup(GroupToBeRemoved.Id, Member.Id);

        if (!result)
        {
            await _snackbarError.Show();
            return;
        }

        Member.Groups.Remove(GroupToBeRemoved);
        await _removeMemberModal.Hide();
        await OnGroupRemoved.InvokeAsync();
        await _snackbarSuccess.Show();
    }

    private async Task OnCancelButton_Clicked()
    {
        await _removeMemberModal.Hide();
    }
}